# –ì–ª–∞–≤–∞ 4: –ö–æ–Ω–µ—á–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã - –ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑

## –û–±–∑–æ—Ä –≥–ª–∞–≤—ã
–ß–µ—Ç–≤–µ—Ä—Ç–∞—è –≥–ª–∞–≤–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ü–µ–ø—Ü–∏—é –∫–æ–Ω–µ—á–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤ (State Machines) - —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö —Å–∏—Å—Ç–µ–º –≤ FPGA. –ò–∑—É—á–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç—ã –ú–∏–ª–∏ –∏ –ú—É—Ä–∞, –∏—Ö —Ä–∞–∑–ª–∏—á–∏—è –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤–µ—Ç–æ—Ñ–æ—Ä–∞, –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –¥–µ–ª–µ–Ω–∏—è –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —è–∑—ã–∫–∞.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ –≥–ª–∞–≤–µ

–ì–ª–∞–≤–∞ 4 —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏—Ö —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –∫–æ–Ω–µ—á–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤:

```
CH4/
‚îú‚îÄ‚îÄ hdl/
‚îÇ   ‚îú‚îÄ‚îÄ traffic_light.sv      # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–µ—Ç–æ—Ñ–æ—Ä–æ–º (–∞–≤—Ç–æ–º–∞—Ç –ú—É—Ä–∞)
‚îÇ   ‚îú‚îÄ‚îÄ calculator_top.sv     # –í–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ calculator_pkg.sv     # –ü–∞–∫–µ—Ç —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ calculator_mealy.sv   # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–µ –ú–∏–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ calculator_moore.sv   # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–µ –ú—É—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ divider_nr.sv        # –î–µ–ª–µ–Ω–∏–µ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ /
‚îî‚îÄ‚îÄ tb/
    ‚îî‚îÄ‚îÄ tb_divider_nr.sv     # –¢–µ—Å—Ç–±–µ–Ω—á –¥–ª—è –¥–µ–ª–∏—Ç–µ–ª—è
```

---

## 1. –û—Å–Ω–æ–≤—ã –∫–æ–Ω–µ—á–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤

![–¢–∏–ø—ã –∫–æ–Ω–µ—á–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤](./images/chapter_4_state_machines.png)
*–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–æ–≤ –ú–∏–ª–∏ –∏ –ú—É—Ä–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏*

### 1.1. –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω–µ—á–Ω–æ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∞
–ö–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç - —ç—Ç–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, —Å–æ—Å—Ç–æ—è—â–∞—è –∏–∑:
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π S** - –∫–æ–Ω–µ—á–Ω—ã–π –Ω–∞–±–æ—Ä –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
- **–í—Ö–æ–¥–Ω–æ–≥–æ –∞–ª—Ñ–∞–≤–∏—Ç–∞ Œ£** - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
- **–§—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ Œ¥** - –ø—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
- **–ù–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è s‚ÇÄ** - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã
- **–í—ã—Ö–æ–¥–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤** - —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ –≤—Ö–æ–¥—ã –∏/–∏–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–æ–≤

**–ê–≤—Ç–æ–º–∞—Ç –ú—É—Ä–∞ (Moore Machine):**
- **–í—ã—Ö–æ–¥—ã –∑–∞–≤–∏—Å—è—Ç —Ç–æ–ª—å–∫–æ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è** - Q = f(State)
- **–í—ã—Ö–æ–¥—ã –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ** —Å –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π
- **–ë–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ** - –≤—ã—Ö–æ–¥—ã —Å—Ç–∞–±–∏–ª—å–Ω—ã –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏
- **–ë–æ–ª—å—à–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π** - –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –≤—ã—Ö–æ–¥–æ–≤ –Ω—É–∂–Ω–æ –æ—Ç–¥–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**–ê–≤—Ç–æ–º–∞—Ç –ú–∏–ª–∏ (Mealy Machine):**
- **–í—ã—Ö–æ–¥—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –ò –≤—Ö–æ–¥–æ–≤** - Q = f(State, Inputs)
- **–í—ã—Ö–æ–¥—ã –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ** –ø—Ä–∏ —Å–º–µ–Ω–µ –≤—Ö–æ–¥–æ–≤
- **–ë—ã—Å—Ç—Ä–µ–µ —Ä–µ–∞–∫—Ü–∏—è** - –≤—ã—Ö–æ–¥—ã –º–µ–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ —Å–º–µ–Ω–µ –≤—Ö–æ–¥–æ–≤
- **–ú–µ–Ω—å—à–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π** - –æ–¥–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –≤—ã—Ö–æ–¥—ã

### 1.2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–æ–≤ –ú–∏–ª–∏ –∏ –ú—É—Ä–∞

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –ú—É—Ä | –ú–∏–ª–∏ | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|----------|-----|------|--------------|
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π** | –ë–æ–ª—å—à–µ | –ú–µ–Ω—å—à–µ | –ú–∏–ª–∏ –¥–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç–∏ |
| **–°–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–∞–∫—Ü–∏–∏** | –ú–µ–¥–ª–µ–Ω–Ω–µ–µ | –ë—ã—Å—Ç—Ä–µ–µ | –ú–∏–ª–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–µ–∞–∫—Ü–∏–∏ |
| **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤—ã—Ö–æ–¥–æ–≤** | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω—è—è | –ú—É—Ä –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ |
| **–û—Ç–ª–∞–¥–∫–∞** | –ü—Ä–æ—â–µ | –°–ª–æ–∂–Ω–µ–µ | –ú—É—Ä –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö |
| **Glitch –Ω–∞ –≤—ã—Ö–æ–¥–∞—Ö** | –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç | –í–æ–∑–º–æ–∂–Ω—ã | –ú—É—Ä –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –≤—ã—Ö–æ–¥–æ–≤ |

---

## 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤–µ—Ç–æ—Ñ–æ—Ä–æ–º - –ê–≤—Ç–æ–º–∞—Ç –ú—É—Ä–∞

![–î–∏–∞–≥—Ä–∞–º–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å–≤–µ—Ç–æ—Ñ–æ—Ä–∞](./images/chapter_4_traffic_light_states.png)
*–î–∏–∞–≥—Ä–∞–º–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–≤–µ—Ç–æ—Ñ–æ—Ä–æ–º —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏*

### 2.1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è traffic_light.sv

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
```systemverilog
module traffic_light #(
    parameter CLK_PER = 10      // –ü–µ—Ä–∏–æ–¥ —á–∞—Å–æ–≤ –≤ ns
) (
    input wire        clk,
    input wire [1:0]  SW,       // SW[0] - —Å–µ–Ω—Å–æ—Ä –ª–µ–≤–æ-–ø—Ä–∞–≤–æ, SW[1] - —Å–µ–Ω—Å–æ—Ä –≤–≤–µ—Ä—Ö-–≤–Ω–∏–∑

    output logic [1:0] R,       // –ö—Ä–∞—Å–Ω—ã–µ —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã [1:0] = [–≤–≤–µ—Ä—Ö-–≤–Ω–∏–∑, –ª–µ–≤–æ-–ø—Ä–∞–≤–æ]
    output logic [1:0] G,       // –ó–µ–ª–µ–Ω—ã–µ —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã
    output logic [1:0] B        // –°–∏–Ω–∏–µ —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã (–∂–µ–ª—Ç—ã–µ)
);
```

### 2.2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç

#### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
```systemverilog
localparam COUNT_1S  = int'(100000000 / CLK_PER);     // –°—á–µ—Ç—á–∏–∫ –Ω–∞ 1 —Å–µ–∫—É–Ω–¥—É
localparam COUNT_10S = 10 * int'(100000000 / CLK_PER); // –°—á–µ—Ç—á–∏–∫ –Ω–∞ 10 —Å–µ–∫—É–Ω–¥

bit [$clog2(COUNT_10S)-1:0] counter;
```

**–†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤:**
- –ü—Ä–∏ CLK_PER = 10ns (100MHz): COUNT_1S = 10,000,000 —Ç–∞–∫—Ç–æ–≤
- COUNT_10S = 100,000,000 —Ç–∞–∫—Ç–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥ –ª—é–±—É—é —á–∞—Å—Ç–æ—Ç—É

#### –°–æ—Å—Ç–æ—è–Ω–∏—è —Å–≤–µ—Ç–æ—Ñ–æ—Ä–∞
```systemverilog
typedef enum bit [2:0] {
    INIT_UD_GREEN,        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: –≤–≤–µ—Ä—Ö-–≤–Ω–∏–∑ –∑–µ–ª–µ–Ω—ã–π
    UD_GREEN_LR_RED,      // –í–≤–µ—Ä—Ö-–≤–Ω–∏–∑ –∑–µ–ª–µ–Ω—ã–π, –ª–µ–≤–æ-–ø—Ä–∞–≤–æ –∫—Ä–∞—Å–Ω—ã–π
    UD_YELLOW_LR_RED,     // –í–≤–µ—Ä—Ö-–≤–Ω–∏–∑ –∂–µ–ª—Ç—ã–π, –ª–µ–≤–æ-–ø—Ä–∞–≤–æ –∫—Ä–∞—Å–Ω—ã–π
    INIT_UD_RED_LR_GREEN, // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: –ª–µ–≤–æ-–ø—Ä–∞–≤–æ –∑–µ–ª–µ–Ω—ã–π
    UD_RED_LR_GREEN,      // –í–≤–µ—Ä—Ö-–≤–Ω–∏–∑ –∫—Ä–∞—Å–Ω—ã–π, –ª–µ–≤–æ-–ø—Ä–∞–≤–æ –∑–µ–ª–µ–Ω—ã–π
    UD_RED_LR_YELLOW      // –í–≤–µ—Ä—Ö-–≤–Ω–∏–∑ –∫—Ä–∞—Å–Ω—ã–π, –ª–µ–≤–æ-–ø—Ä–∞–≤–æ –∂–µ–ª—Ç—ã–π
} state_t;

state_t state;
```

### 2.3. –î–µ—Ç–µ–∫—Ü–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞

#### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä—ã —Å–µ–Ω—Å–æ—Ä–æ–≤
```systemverilog
logic [2:0] lr_reg;     // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä –¥–ª—è –ª–µ–≤–æ-–ø—Ä–∞–≤–æ
logic [2:0] ud_reg;     // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä –¥–ª—è –≤–≤–µ—Ä—Ö-–≤–Ω–∏–∑

always @(posedge clk) begin
    lr_reg <= lr_reg << 1 | SW[0];     // –°–¥–≤–∏–≥ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ –±–∏—Ç–∞
    ud_reg <= ud_reg << 1 | SW[1];     // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
end
```

**–ü—Ä–∏–Ω—Ü–∏–ø –¥–µ—Ç–µ–∫—Ü–∏–∏:**
- **–¢—Ä–∏ –±–∏—Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä–∞** –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —É—Å—Ç–æ–π—á–∏–≤–æ–µ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **lr_reg[2]** —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–µ–Ω—Å–æ—Ä–∞
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–º–µ—Ö** - –∫–æ—Ä–æ—Ç–∫–∏–µ –∏–º–ø—É–ª—å—Å—ã —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è
- **–î–µ—Ç–µ–∫—Ü–∏—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞** –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ —Å–æ—Å—Ç–æ—è–Ω–∏–π

### 2.4. –õ–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏

#### –û—Å–Ω–æ–≤–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–π
```systemverilog
always @(posedge clk) begin
    enable_count <= '0;     // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å—á–µ—Ç—á–∏–∫ –≤—ã–∫–ª—é—á–µ–Ω

    case (state)
        INIT_UD_GREEN: begin
            up_down      <= GREEN;
            left_right   <= RED;
            enable_count <= '1;                         // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
            if (counter == COUNT_10S)
                state <= UD_GREEN_LR_RED;               // –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ —Ç–∞–π–º–µ—Ä—É
        end

        UD_GREEN_LR_RED: begin
            up_down    <= GREEN;
            left_right <= RED;
            if (lr_reg[2])
                state <= UD_YELLOW_LR_RED;              // –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ –¥–µ—Ç–µ–∫—Ü–∏–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
        end

        UD_YELLOW_LR_RED: begin
            up_down      <= YELLOW;
            left_right   <= RED;
            enable_count <= '1;                         // –ñ–µ–ª—Ç—ã–π –≥–æ—Ä–∏—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
            if (counter == COUNT_10S)
                state <= INIT_UD_RED_LR_GREEN;
        end

        // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –¥—Ä—É–≥–∏—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π...
    endcase
end
```

### 2.5. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–º

#### –õ–æ–≥–∏–∫–∞ —Ç–∞–π–º–µ—Ä–∞
```systemverilog
always @(posedge clk) begin
    if (enable_count) begin
        counter <= counter + 1'b1;      // –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
    end else begin
        counter <= '0;                  // –°–±—Ä–æ—Å –ø—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
    end
end
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å** –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑ —Ç–∞–π–º–µ—Ä–∞
- **–ï–¥–∏–Ω—ã–π —Å—á–µ—Ç—á–∏–∫** –¥–ª—è –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
- **–≠–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** - —Å—á–µ—Ç—á–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### 2.6. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–≤–µ—Ç–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤

#### RGB —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```systemverilog
typedef enum bit [1:0] {
    RED,       // 00
    YELLOW,    // 01
    GREEN      // 10
} light_t;

light_t up_down;
light_t left_right;

// –ú–∏–≥–∞–Ω–∏–µ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏
logic light_count;
always @(posedge clk) begin
    light_count <= ~light_count;    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞–∂–¥—ã–π —Ç–∞–∫—Ç
end

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è RGB —Å–∏–≥–Ω–∞–ª–æ–≤
always @(posedge clk) begin
    R <= '0;
    G <= '0;
    B <= '0;

    if (light_count) begin          // –ú–∏–≥–∞–Ω–∏–µ 50% —Å–∫–≤–∞–∂–Ω–æ—Å—Ç–∏
        case (left_right)
            GREEN:  G[0] <= '1;     // –ó–µ–ª–µ–Ω—ã–π
            YELLOW: begin R[0] <= '1; G[0] <= '1; end  // –ñ–µ–ª—Ç—ã–π = –∫—Ä–∞—Å–Ω—ã–π + –∑–µ–ª–µ–Ω—ã–π
            RED:    R[0] <= '1;     // –ö—Ä–∞—Å–Ω—ã–π
        endcase

        case (up_down)
            GREEN:  G[1] <= '1;
            YELLOW: begin R[1] <= '1; G[1] <= '1; end
            RED:    R[1] <= '1;
        endcase
    end
end
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ü–≤–µ—Ç–æ–≤:**
- **–ö—Ä–∞—Å–Ω—ã–π** = R=1, G=0, B=0
- **–ó–µ–ª–µ–Ω—ã–π** = R=0, G=1, B=0
- **–ñ–µ–ª—Ç—ã–π** = R=1, G=1, B=0 (–∞–¥–¥–∏—Ç–∏–≤–Ω–æ–µ —Å–º–µ—à–∏–≤–∞–Ω–∏–µ)
- **–ú–∏–≥–∞–Ω–∏–µ** —É–ª—É—á—à–∞–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å –∏ —ç–∫–æ–Ω–æ–º–∏—Ç —ç–Ω–µ—Ä–≥–∏—é

---

## 3. –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–æ–≤ –ú–∏–ª–∏ –∏ –ú—É—Ä–∞

![–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞](./images/chapter_4_calculator_architecture.png)
*–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è —Å—Ö–µ–º–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ —Å –≤—ã–±–∏—Ä–∞–µ–º—ã–º —Ç–∏–ø–æ–º –∞–≤—Ç–æ–º–∞—Ç–∞*

### 3.1. –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (calculator_top.sv)

#### –ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```systemverilog
module calculator_top #(
    parameter BITS         = 32,            // –†–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
    parameter NUM_SEGMENTS = 8,             // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑—Ä—è–¥–æ–≤ –¥–∏—Å–ø–ª–µ—è
    parameter SM_TYPE      = "MEALY",       // –¢–∏–ø –∞–≤—Ç–æ–º–∞—Ç–∞: "MEALY" –∏–ª–∏ "MOORE"
    parameter USE_PLL      = "TRUE"         // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PLL –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ 50MHz
) (
    input wire                      clk,
    input wire [15:0]               SW,       // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ –¥–ª—è –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö
    input wire [4:0]                buttons,  // –ö–Ω–æ–ø–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–π

    output logic [NUM_SEGMENTS-1:0] anode,    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä—è–¥–∞–º–∏ –¥–∏—Å–ø–ª–µ—è
    output logic [7:0]              cathode   // –°–µ–≥–º–µ–Ω—Ç—ã –¥–∏—Å–ø–ª–µ—è
);
```

### 3.2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å PLL

#### –£—Å–ª–æ–≤–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è PLL
```systemverilog
logic clk_50;

generate
    if (USE_PLL == "TRUE") begin : g_USE_PLL
        sys_pll u_sys_pll (
            .clk_in1  (clk),        // –í—Ö–æ–¥–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ (–æ–±—ã—á–Ω–æ 100MHz)
            .clk_out1 (clk_50)      // –í—ã—Ö–æ–¥–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ 50MHz
        );
    end else begin : g_NO_PLL
        assign clk_50 = clk;        // –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
    end
endgenerate
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è PLL:**
- **–¢–æ—á–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞** –¥–ª—è —Å–µ–º–∏—Å–µ–≥–º–µ–Ω—Ç–Ω–æ–≥–æ –¥–∏—Å–ø–ª–µ—è
- **–£–º–µ–Ω—å—à–µ–Ω–∏–µ EMI** - –±–æ–ª–µ–µ –Ω–∏–∑–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ –∫–æ–º–º—É—Ç–∞—Ü–∏–∏
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è** - –º–µ–Ω—å—à–∞—è —á–∞—Å—Ç–æ—Ç–∞ = –º–µ–Ω—å—à–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ
- **–ì–∏–±–∫–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –∏–∑–º–µ–Ω–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏

### 3.3. –ü–∞–∫–µ—Ç —Ñ—É–Ω–∫—Ü–∏–π (calculator_pkg.sv)

#### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π
```systemverilog
package calculator_pkg;
    localparam NUM_SEGMENTS = `NUM_SEGMENTS;

    // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è –∫–Ω–æ–ø–æ–∫ (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –±–∏—Ç–æ–≤—ã–º –ø–æ–∑–∏—Ü–∏—è–º)
    localparam UP           = 3'd0;     // –£–º–Ω–æ–∂–µ–Ω–∏–µ
    localparam DOWN         = 3'd1;     // –û—á–∏—Å—Ç–∫–∞ (Clear)
    localparam LEFT         = 3'd2;     // –°–ª–æ–∂–µ–Ω–∏–µ
    localparam RIGHT        = 3'd3;     // –í—ã—á–∏—Ç–∞–Ω–∏–µ
    localparam CENTER       = 3'd4;     // –†–∞–≤–Ω–æ (=)
```

#### –§—É–Ω–∫—Ü–∏—è –¥–≤–æ–∏—á–Ω–æ-–¥–µ—Å—è—Ç–∏—á–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
```systemverilog
function bit [NUM_SEGMENTS-1:0][3:0] bin_to_bcd;
    input [31:0] bin_in;
    bit [NUM_SEGMENTS*4-1:0] shifted;

    // –ê–ª–≥–æ—Ä–∏—Ç–º Double Dabble (Add-3)
    shifted = {30'b0, bin_in[31:30]};           // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ä—à–∏–º–∏ –±–∏—Ç–∞–º–∏

    for (int i = 29; i >= 1; i--) begin
        shifted = shifted << 1 | bin_in[i];     // –°–¥–≤–∏–≥ –≤–ª–µ–≤–æ —Å –¥–æ–±–∞—á–µ–π –±–∏—Ç–∞

        for (int j = 0; j < NUM_SEGMENTS; j++) begin
            if (shifted[j*4+:4] > 4)            // –ï—Å–ª–∏ —Ç–µ—Ç—Ä–∞–¥–∞ > 4
                shifted[j*4+:4] += 3;           // –î–æ–±–∞–≤–∏—Ç—å 3 (–∫–æ—Ä—Ä–µ–∫—Ü–∏—è BCD)
        end
    end

    shifted = shifted << 1 | bin_in[0];         // –ü–æ—Å–ª–µ–¥–Ω–∏–π –±–∏—Ç

    // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ BCD —Ç–µ—Ç—Ä–∞–¥
    for (int i = 0; i < NUM_SEGMENTS; i++) begin
        bin_to_bcd[i] = shifted[4*i+:4];
    end
endfunction
```

**–ê–ª–≥–æ—Ä–∏—Ç–º Double Dabble:**
1. **–°–¥–≤–∏–≥ –¥–≤–æ–∏—á–Ω–æ–≥–æ —á–∏—Å–ª–∞ –≤–ª–µ–≤–æ** –±–∏—Ç –∑–∞ –±–∏—Ç–æ–º
2. **–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Å–¥–≤–∏–≥–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ—Ç—Ä–∞–¥ BCD**
3. **–ï—Å–ª–∏ —Ç–µ—Ç—Ä–∞–¥–∞ > 4, –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è 3** (–∫–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª—è BCD)
4. **–†–µ–∑—É–ª—å—Ç–∞—Ç** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ BCD –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ

### 3.4. –ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞ –∫–Ω–æ–ø–æ–∫

#### –£–ª—É—á—à–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º DEBOUNCE
```systemverilog
(* ASYNC_REG = "TRUE" *) logic [2:0] button_sync;
logic counter_en;
logic [7:0] counter;
logic button_down;
logic [4:0] button_capt;    // –ó–∞—Ö–≤–∞—á–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
logic [15:0] sw_capt;       // –ó–∞—Ö–≤–∞—á–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π

always @(posedge clk_50) begin
    button_down <= '0;
    button_capt <= '0;
    button_sync <= button_sync << 1 | (|buttons);      // OR –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫

    if (button_sync[2:1] == 2'b01)
        counter_en <= '1;                               // –î–µ—Ç–µ–∫—Ü–∏—è —Ñ—Ä–æ–Ω—Ç–∞
    else if (~button_sync[1])
        counter_en <= '0;                               // –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—É—â–µ–Ω–∞

    if (counter_en) begin
        counter <= counter + 1'b1;
        if (&counter) begin                             // 255 —Ç–∞–∫—Ç–æ–≤ –ø—Ä–æ—à–ª–æ
            counter_en  <= '0;
            counter     <= '0;
            button_down <= '1;                          // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ
            button_capt <= buttons;                     // –ó–∞—Ö–≤–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫
            sw_capt     <= SW;                          // –ó–∞—Ö–≤–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π
        end
    end
end
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- **–ó–∞—Ö–≤–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è** –≤ –º–æ–º–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–∞–∂–∞—Ç–∏—è
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π** –≤–æ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è** –ª—é–±–æ–π –∏–∑ 5 –∫–Ω–æ–ø–æ–∫
- **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** –ø—Ä–∏ —á–∞—Å—Ç–æ—Ç–µ 50MHz

### 3.5. –ê–≤—Ç–æ–º–∞—Ç –ú–∏–ª–∏ (calculator_mealy.sv)

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π
```systemverilog
typedef enum bit {
    IDLE,           // –û–∂–∏–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –æ–ø–µ—Ä–∞–Ω–¥–∞ –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
    WAIT4BUTTON     // –û–∂–∏–¥–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –æ–ø–µ—Ä–∞–Ω–¥–∞ –∏ —Å–ª–µ–¥—É—é—â–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
} state_t;

(* mark_debug = "true" *) state_t state;
(* mark_debug = "true" *) logic [4:0] last_op;        // –ü–æ—Å–ª–µ–¥–Ω—è—è –æ–ø–µ—Ä–∞—Ü–∏—è
(* mark_debug = "true" *) logic [BITS-1:0] accumulator; // –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä
```

#### –õ–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∞ –ú–∏–ª–∏
```systemverilog
always @(posedge clk) begin
    done <= '0;
    case (state)
        IDLE: begin
            accumulator <= '0;                          // –°–±—Ä–æ—Å –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞
            last_op     <= buttons;                     // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
            accumulator <= switch;                      // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –æ–ø–µ—Ä–∞–Ω–¥–∞

            if (start)
                state <= buttons[DOWN] ? IDLE : WAIT4BUTTON; // Clear –æ—Å—Ç–∞–µ—Ç—Å—è –≤ IDLE
        end

        WAIT4BUTTON: begin
            if (start) begin
                last_op <= buttons;                     // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏

                // –í–´–ü–û–õ–ù–ï–ù–ò–ï –û–ü–ï–†–ê–¶–ò–ò –°–†–ê–ó–£ (–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –ú–∏–ª–∏)
                case (1'b1)
                    last_op[UP]:    accumulator <= accumulator * switch; // –£–º–Ω–æ–∂–µ–Ω–∏–µ
                    last_op[DOWN]:  state       <= IDLE;                 // Clear
                    last_op[LEFT]:  accumulator <= accumulator + switch; // –°–ª–æ–∂–µ–Ω–∏–µ
                    last_op[RIGHT]: accumulator <= accumulator - switch; // –í—ã—á–∏—Ç–∞–Ω–∏–µ
                    default:        state       <= WAIT4BUTTON;          // –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
                endcase
            end else
                state <= WAIT4BUTTON;
        end
    endcase
end

assign accum = accumulator;     // –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∞ –ú–∏–ª–∏:**
- **–í—ã—Ö–æ–¥—ã –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É** –ø—Ä–∏ —Å–º–µ–Ω–µ –≤—Ö–æ–¥–æ–≤
- **–û–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ç–æ–º –∂–µ —Ç–∞–∫—Ç–µ** –∫–æ–≥–¥–∞ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞
- **–ë—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–∫—Ü–∏—è** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ 1 —Ç–∞–∫—Ç –ø–æ—Å–ª–µ –∫–Ω–æ–ø–∫–∏
- **–ú–µ–Ω—å—à–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π** - –≤—Å–µ–≥–æ 2 —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### 3.6. –ê–≤—Ç–æ–º–∞—Ç –ú—É—Ä–∞ (calculator_moore.sv)

#### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
```systemverilog
typedef enum bit [2:0] {
    IDLE,           // –û–∂–∏–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –æ–ø–µ—Ä–∞–Ω–¥–∞
    WAIT4BUTTON,    // –û–∂–∏–¥–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –æ–ø–µ—Ä–∞–Ω–¥–∞ –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
    ADD,            // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ª–æ–∂–µ–Ω–∏—è
    SUB,            // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—ã—á–∏—Ç–∞–Ω–∏—è
    MULT            // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É–º–Ω–æ–∂–µ–Ω–∏—è
} state_t;

(* mark_debug = "true" *) state_t state;
(* mark_debug = "true" *) logic [4:0] op_store;      // –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏
(* mark_debug = "true" *) logic [4:0] last_op;       // –ü–æ—Å–ª–µ–¥–Ω—è—è –æ–ø–µ—Ä–∞—Ü–∏—è
(* mark_debug = "true" *) logic [BITS-1:0] accumulator;
```

#### –õ–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∞ –ú—É—Ä–∞
```systemverilog
always @(posedge clk) begin
    done <= '0;
    case (state)
        IDLE: begin
            accumulator <= '0;
            last_op     <= buttons;
            accumulator <= switch;
            if (start)
                state <= buttons[DOWN] ? IDLE : WAIT4BUTTON;
        end

        WAIT4BUTTON: begin
            op_store <= buttons;                        // –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
            if (start) begin
                case (1'b1)
                    last_op[UP]:     state <= MULT;     // –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É–º–Ω–æ–∂–µ–Ω–∏—è
                    last_op[DOWN]:   state <= IDLE;     // Clear
                    last_op[LEFT]:   state <= ADD;      // –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–ª–æ–∂–µ–Ω–∏—è
                    last_op[RIGHT]:  state <= SUB;      // –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—ã—á–∏—Ç–∞–Ω–∏—è
                    default:         state <= WAIT4BUTTON;
                endcase
            end else
                state <= WAIT4BUTTON;
        end

        MULT: begin
            last_op     <= op_store;                    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
            accumulator <= accumulator * switch;        // –í–´–ü–û–õ–ù–ï–ù–ò–ï –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
            state       <= WAIT4BUTTON;                 // –í–æ–∑–≤—Ä–∞—Ç –∫ –æ–∂–∏–¥–∞–Ω–∏—é
        end

        ADD: begin
            last_op     <= op_store;
            accumulator <= accumulator + switch;
            state       <= WAIT4BUTTON;
        end

        SUB: begin
            last_op     <= op_store;
            accumulator <= accumulator - switch;
            state       <= WAIT4BUTTON;
        end
    endcase
end
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∞ –ú—É—Ä–∞:**
- **–û–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö**
- **–í—ã—Ö–æ–¥—ã —Å—Ç–∞–±–∏–ª—å–Ω—ã** - –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–º–µ–Ω–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **–ë–æ–ª—å—à–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π** - –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é –¥–ª—è –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤** - op_store –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
- **–ó–∞–¥–µ—Ä–∂–∫–∞ –Ω–∞ 1 —Ç–∞–∫—Ç** - –æ–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ç–∞–∫—Ç–µ

### 3.7. –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∞–≤—Ç–æ–º–∞—Ç–∞

#### Generate –±–ª–æ–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
```systemverilog
generate
    if (SM_TYPE == "MOORE") begin : g_MOORE
        calculator_moore #(.BITS(BITS)) u_sm (
            .clk     (clk_50),
            .start   (button_down),
            .buttons (button_capt),
            .switch  (sw_capt),
            .done    (),
            .accum   (accumulator)
        );
    end else begin : g_MEALY
        calculator_mealy #(.BITS(BITS)) u_sm (
            .clk     (clk_50),
            .start   (button_down),
            .buttons (button_capt),
            .switch  (sw_capt),
            .done    (),
            .accum   (accumulator)
        );
    end
endgenerate
```

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π:**

| –ê—Å–ø–µ–∫—Ç | –ê–≤—Ç–æ–º–∞—Ç –ú–∏–ª–∏ | –ê–≤—Ç–æ–º–∞—Ç –ú—É—Ä–∞ | –õ—É—á—à–∏–π –≤—ã–±–æ—Ä |
|--------|-------------|-------------|--------------|
| **–°–æ—Å—Ç–æ—è–Ω–∏–π** | 2 | 5 | –ú–∏–ª–∏ (–∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ) |
| **–°–∫–æ—Ä–æ—Å—Ç—å** | 1 —Ç–∞–∫—Ç | 2 —Ç–∞–∫—Ç–∞ | –ú–∏–ª–∏ (–±—ã—Å—Ç—Ä–µ–µ) |
| **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∞—è | –ú—É—Ä (—Å—Ç–∞–±–∏–ª—å–Ω–µ–µ) |
| **–û—Ç–ª–∞–¥–∫–∞** | –°–ª–æ–∂–Ω–µ–µ | –ü—Ä–æ—â–µ | –ú—É—Ä (–ø–æ–Ω—è—Ç–Ω–µ–µ) |
| **–†–µ—Å—É—Ä—Å—ã** | –ú–µ–Ω—å—à–µ | –ë–æ–ª—å—à–µ | –ú–∏–ª–∏ (—ç–∫–æ–Ω–æ–º–∏—á–Ω–µ–µ) |

---

## 4. –ê–ª–≥–æ—Ä–∏—Ç–º –¥–µ–ª–µ–Ω–∏—è –±–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –¥–µ–ª–µ–Ω–∏—è

![–ê–ª–≥–æ—Ä–∏—Ç–º –¥–µ–ª–µ–Ω–∏—è](./images/chapter_4_division_algorithm.png)
*–ü–æ—à–∞–≥–æ–≤–∞—è –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–∞*

### 4.1. –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã

#### –ê–ª–≥–æ—Ä–∏—Ç–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–∞
–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –¥–µ–ª–µ–Ω–∏—è —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–µ–ª–µ–Ω–∏—è:

**–ü—Ä–∏–Ω—Ü–∏–ø:**
1. **–°–¥–≤–∏–≥ –≤–ª–µ–≤–æ** –¥–µ–ª–∏–º–æ–≥–æ —Å –æ–±–Ω—É–ª–µ–Ω–∏–µ–º –º–ª–∞–¥—à–µ–≥–æ –±–∏—Ç–∞
2. **–í—ã—á–∏—Ç–∞–Ω–∏–µ –¥–µ–ª–∏—Ç–µ–ª—è** –∏–∑ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –æ—Å—Ç–∞—Ç–∫–∞
3. **–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π** - –≤ —á–∞—Å—Ç–Ω–æ–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è 1
4. **–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π** - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –æ—Å—Ç–∞—Ç–æ–∫, –≤ —á–∞—Å—Ç–Ω–æ–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è 0
5. **–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ** –¥–ª—è –≤—Å–µ—Ö –±–∏—Ç–æ–≤

### 4.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è divider_nr.sv

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
```systemverilog
module divider_nr #(
    parameter BITS = 16         // –†–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞–Ω–¥–æ–≤
) (
    input wire                      clk,
    input wire                      start,
    input wire unsigned [BITS-1:0]  dividend,    // –î–µ–ª–∏–º–æ–µ
    input wire unsigned [BITS-1:0]  divisor,     // –î–µ–ª–∏—Ç–µ–ª—å

    output logic                    done,
    output logic unsigned [BITS-1:0] quotient,   // –ß–∞—Å—Ç–Ω–æ–µ
    output logic unsigned [BITS-1:0] remainder   // –û—Å—Ç–∞—Ç–æ–∫
);
```

### 4.3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π

#### –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞
```systemverilog
enum bit [3:0] {
    IDLE,                    // –û–∂–∏–¥–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã —Å—Ç–∞—Ä—Ç–∞
    INIT,                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
    LEFT_SHIFT,              // –°–¥–≤–∏–≥ –≤–ª–µ–≤–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞ {–æ—Å—Ç–∞—Ç–æ–∫, —á–∞—Å—Ç–Ω–æ–µ}
    TEST_REMAINDER[2],       // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞–∫–∞ –æ—Å—Ç–∞—Ç–∫–∞ (—Å–æ—Å—Ç–æ—è–Ω–∏—è 3-4)
    ADJ_REMAINDER[3],        // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –æ—Å—Ç–∞—Ç–∫–∞ (—Å–æ—Å—Ç–æ—è–Ω–∏—è 5-7)
    UPDATE_QUOTIENT,         // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∏—Ç–∞ —á–∞—Å—Ç–Ω–æ–≥–æ
    TEST_N,                  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—á–µ—Ç—á–∏–∫–∞ –±–∏—Ç–æ–≤
    DIV_DONE                 // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–µ–ª–µ–Ω–∏—è
} state;
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ enum —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏:**
- **TEST_REMAINDER[2]** —Å–æ–∑–¥–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è TEST_REMAINDER0 –∏ TEST_REMAINDER1
- **ADJ_REMAINDER[3]** —Å–æ–∑–¥–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è ADJ_REMAINDER0, ADJ_REMAINDER1, ADJ_REMAINDER2
- **–ö–æ–º–ø–∞–∫—Ç–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ** –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ—Ö–æ–∂–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è** —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### 4.4. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞

#### –ü–æ–¥—Å—á–µ—Ç –≤–µ–¥—É—â–∏—Ö –±–∏—Ç–æ–≤
```systemverilog
localparam BC = $clog2(BITS);
logic [BC:0] num_bits_w;    // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞—á–∞—â–∏—Ö –±–∏—Ç–æ–≤ –≤ –¥–µ–ª–∏–º–æ–º
logic [BC:0] num_bits;      // –†–∞–±–æ—á–∏–π —Å—á–µ—Ç—á–∏–∫ –±–∏—Ç–æ–≤

leading_ones #(
    .SELECTOR  ("DOWN_FOR"),
    .BITS      (BITS)
) u_leading_ones (
    .SW        (dividend),
    .LED       (num_bits_w)
);
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞:**
- **–ü–æ–¥—Å—á–µ—Ç –∑–Ω–∞—á–∞—â–∏—Ö –±–∏—Ç–æ–≤** –≤ –¥–µ–ª–∏–º–æ–º
- **–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏—Ç–µ—Ä–∞—Ü–∏–π** - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–Ω–∞—á–∞—â–∏–µ –±–∏—Ç—ã
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–ª—è –º–∞–ª—ã—Ö —á–∏—Å–µ–ª** - –¥–µ–ª–µ–Ω–∏–µ 8 –Ω–∞ 3 —Ç—Ä–µ–±—É–µ—Ç 4 –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–æ 16

#### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫
```systemverilog
logic signed [BITS:0] int_remainder;    // –û—Å—Ç–∞—Ç–æ–∫ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –∑–Ω–∞–∫–æ–≤—ã–º –±–∏—Ç–æ–º
```

**–ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:**
- **–î–µ—Ç–µ–∫—Ü–∏—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è** –ø—Ä–∏ –≤—ã—á–∏—Ç–∞–Ω–∏–∏
- **–ó–Ω–∞–∫–æ–≤—ã–π –±–∏—Ç** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- **–ò–∑–±–µ–∂–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö** –ø—Ä–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ

### 4.5. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞

#### –û—Å–Ω–æ–≤–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–π
```systemverilog
always @(posedge clk) begin
    done <= '0;
    case (state)
        IDLE: begin
            if (start) state <= INIT;
        end

        INIT: begin
            state         <= LEFT_SHIFT;
            quotient      <= dividend << (BITS - num_bits_w);    // –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é
            int_remainder <= '0;                                 // –ù–∞—á–∞–ª—å–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫ = 0
            num_bits      <= num_bits_w;                         // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π
        end

        LEFT_SHIFT: begin
            // –°–¥–≤–∏–≥ –≤–ª–µ–≤–æ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞ {–æ—Å—Ç–∞—Ç–æ–∫, —á–∞—Å—Ç–Ω–æ–µ}
            {int_remainder, quotient} <= {int_remainder, quotient} << 1;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞–∫–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏
            if (int_remainder[$left(int_remainder)])
                state <= ADJ_REMAINDER0;    // –û—Å—Ç–∞—Ç–æ–∫ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π - —Å–ª–æ–∂–µ–Ω–∏–µ
            else
                state <= ADJ_REMAINDER1;    // –û—Å—Ç–∞—Ç–æ–∫ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π - –≤—ã—á–∏—Ç–∞–Ω–∏–µ
        end

        ADJ_REMAINDER0: begin
            state         <= UPDATE_QUOTIENT;
            int_remainder <= int_remainder + divisor;    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–∞
        end

        ADJ_REMAINDER1: begin
            state         <= UPDATE_QUOTIENT;
            int_remainder <= int_remainder - divisor;    // –ü—Ä–æ–±–Ω–æ–µ –≤—ã—á–∏—Ç–∞–Ω–∏–µ
        end

        UPDATE_QUOTIENT: begin
            state       <= TEST_N;
            // –ë–∏—Ç —á–∞—Å—Ç–Ω–æ–≥–æ = –∏–Ω–≤–µ—Ä—Å–∏—è –∑–Ω–∞–∫–æ–≤–æ–≥–æ –±–∏—Ç–∞ –æ—Å—Ç–∞—Ç–∫–∞
            quotient[0] <= ~int_remainder[$left(int_remainder)];
            num_bits    <= num_bits - 1'b1;             // –î–µ–∫—Ä–µ–º–µ–Ω—Ç —Å—á–µ—Ç—á–∏–∫–∞
        end

        TEST_N: begin
            if (|num_bits)                              // –ï—â–µ –µ—Å—Ç—å –±–∏—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
                state <= LEFT_SHIFT;
            else
                state <= TEST_REMAINDER1;               // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–µ
        end

        TEST_REMAINDER1: begin
            if (int_remainder[$left(int_remainder)])    // –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞–∫–∞
                state <= ADJ_REMAINDER2;                // –ù—É–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞
            else
                state <= DIV_DONE;                      // –î–µ–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
        end

        ADJ_REMAINDER2: begin
            state         <= DIV_DONE;
            int_remainder <= int_remainder + divisor;    // –§–∏–Ω–∞–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞
        end

        DIV_DONE: begin
            done  <= '1;                                // –°–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
            state <= IDLE;                              // –í–æ–∑–≤—Ä–∞—Ç –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        end
    endcase
end

assign remainder = int_remainder[BITS-1:0];     // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Å—Ç–∞—Ç–∫–∞
```

### 4.6. –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞

#### –ü—Ä–∏–º–µ—Ä: 11 √∑ 3
```
–ò—Ç–µ—Ä–∞—Ü–∏—è 0: remainder=0000, quotient=1011, –¥–µ–ª–∏–º–æ–µ = 11
LEFT_SHIFT: remainder=0001, quotient=0110  (—Å–¥–≤–∏–≥ {0000,1011} << 1)
ADJ_REM1:   remainder=1110, quotient=0110  (1-3=-2, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ)
UPD_QUOT:   quotient[0]=0, remainder=1110  (—á–∞—Å—Ç–Ω–æ–µ[0] = ~(–∑–Ω–∞–∫))

–ò—Ç–µ—Ä–∞—Ü–∏—è 1: remainder=1110, quotient=0110
LEFT_SHIFT: remainder=1100, quotient=1100  (—Å–¥–≤–∏–≥ {1110,0110} << 1)
ADJ_REM0:   remainder=1111, quotient=1100  (-4+3=-1, –≤—Å–µ –µ—â–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ)
UPD_QUOT:   quotient[0]=0, remainder=1111  (—á–∞—Å—Ç–Ω–æ–µ[0] = ~(–∑–Ω–∞–∫))

–ò—Ç–µ—Ä–∞—Ü–∏—è 2: remainder=1111, quotient=1100
LEFT_SHIFT: remainder=1111, quotient=1000  (—Å–¥–≤–∏–≥ {1111,1100} << 1)
ADJ_REM0:   remainder=0010, quotient=1000  (-1+3=2, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ)
UPD_QUOT:   quotient[0]=1, remainder=0010  (—á–∞—Å—Ç–Ω–æ–µ[0] = ~(–∑–Ω–∞–∫))

–ò—Ç–µ—Ä–∞—Ü–∏—è 3: remainder=0010, quotient=1001
LEFT_SHIFT: remainder=0100, quotient=0010  (—Å–¥–≤–∏–≥ {0010,1001} << 1)
ADJ_REM1:   remainder=0001, quotient=0010  (4-3=1, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ)
UPD_QUOT:   quotient[0]=1, remainder=0001  (—á–∞—Å—Ç–Ω–æ–µ[0] = ~(–∑–Ω–∞–∫))

–†–µ–∑—É–ª—å—Ç–∞—Ç: quotient=0011 (3), remainder=0001 (1)
–ü—Ä–æ–≤–µ—Ä–∫–∞: 3*3+1 = 10... –ì–¥–µ –æ—à–∏–±–∫–∞?
```

**–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
- –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏
- –¢—Ä–µ–±—É–µ—Ç—Å—è —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
- –†–µ–∑—É–ª—å—Ç–∞—Ç: 11 √∑ 3 = 3 –æ—Å—Ç–∞—Ç–æ–∫ 2

---

## 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

### 5.1. –¢–µ—Å—Ç–±–µ–Ω—á –¥–ª—è –¥–µ–ª–∏—Ç–µ–ª—è (tb_divider_nr.sv)

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∞
```systemverilog
module tb;
    parameter BITS = 16;

    bit             clk;
    bit             start;
    bit [BITS-1:0]  dividend;
    bit [BITS-1:0]  divisor;

    bit             done;
    bit [BITS-1:0]  quotient;
    bit [BITS-1:0]  remainder;

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–∞–∫—Ç–æ–≤–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
    initial clk = '0;
    always clk = #5 ~clk;       // 100MHz

    // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª—è
    divider_nr #(.BITS(BITS)) u_divider_nr (.*);
```

#### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
```systemverilog
initial begin
    start = '0;
    dividend = '0;
    divisor = '0;
    repeat (5) @(posedge clk);

    // –¢–µ—Å—Ç 1: –ü—Ä–æ—Å—Ç–æ–µ –¥–µ–ª–µ–Ω–∏–µ
    dividend <= 16'd11;
    divisor  <= 16'd3;
    start    <= '1;
    @(posedge clk);
    start    <= '0;
    while (!done) @(posedge clk);

    // –¢–µ—Å—Ç 2: –°–ª—É—á–∞–π–Ω—ã–µ —á–∏—Å–ª–∞
    for (int i = 0; i < 100; i++) begin
        dividend <= $random;
        divisor  <= $random;
        start    <= '1;
        @(posedge clk);
        start    <= '0;
        while (!done) @(posedge clk);
        repeat (5) @(posedge clk);
    end

    // –¢–µ—Å—Ç 3: –î–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å
    dividend = '0;
    divisor  = '0;
    start    <= '1;
    @(posedge clk);
    start    <= '0;
    while (!done) @(posedge clk);

    $finish;
end
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
```systemverilog
always @(posedge clk) begin
    if (done &&
        (quotient != dividend/divisor) &&
        (remainder != dividend%divisor)) begin
        $display("–û–®–ò–ë–ö–ê:");
        $display("–ß–∞—Å—Ç–Ω–æ–µ:      %d", quotient);
        $display("–û—Å—Ç–∞—Ç–æ–∫:      %d", remainder);
        $display("–û–∂–∏–¥–∞–µ–º–æ–µ Q:  %d", dividend/divisor);
        $display("–û–∂–∏–¥–∞–µ–º–æ–µ R:  %d", dividend%divisor);
        $stop;
    end
end
```

### 5.2. –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã

#### mark_debug –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
```systemverilog
(* mark_debug = "true" *) logic [4:0]       last_op;
(* mark_debug = "true" *) logic [BITS-1:0]  accumulator;
(* mark_debug = "true" *) state_t state;
```

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ—Ç–ª–∞–¥–∫–∏:**
1. **–ö–ª—é—á–µ–≤—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∞
2. **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** - –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä, –æ—Å—Ç–∞—Ç–æ–∫, —á–∞—Å—Ç–Ω–æ–µ
3. **–í–Ω–µ—à–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è** - –∫–Ω–æ–ø–∫–∏, –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏
4. **–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏** - —Å—á–µ—Ç—á–∏–∫–∏, —Ç–∞–π–º–µ—Ä—ã

---

## 6. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 6.1. –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∞–≤—Ç–æ–º–∞—Ç–∞

#### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–±–æ—Ä–∞

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç –ú—É—Ä–∞ –∫–æ–≥–¥–∞:**
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤—ã—Ö–æ–¥–æ–≤ –∫—Ä–∏—Ç–∏—á–Ω–∞** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ—Ç–æ—Ä–∞–º–∏, —Å–≤–µ—Ç–æ—Ñ–æ—Ä–∞–º–∏
- ‚úÖ **–û—Ç–ª–∞–¥–∫–∞ –≤–∞–∂–Ω–µ–µ —Å–∫–æ—Ä–æ—Å—Ç–∏** - —Å–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã, –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ **–ú–Ω–æ–≥–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤—ã—Ö–æ–¥–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π** - –¥–µ–∫–æ–¥–µ—Ä—ã, –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–∞** - automotive, aerospace, –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç –ú–∏–ª–∏ –∫–æ–≥–¥–∞:**
- ‚úÖ **–°–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–∞–∫—Ü–∏–∏ –∫—Ä–∏—Ç–∏—á–Ω–∞** - –≤—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã, DSP
- ‚úÖ **–†–µ—Å—É—Ä—Å—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã** - –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, edge computing
- ‚úÖ **–ú–∞–ª–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤—ã—Ö–æ–¥–æ–≤** - –ø—Ä–æ—Å—Ç—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, —Ñ–∏–ª—å—Ç—Ä—ã
- ‚úÖ **Pipe-line –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã, DSP –±–ª–æ–∫–∏

### 6.2. –®–∞–±–ª–æ–Ω—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–æ–≤

#### –ë–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∞
```systemverilog
// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤
typedef enum bit [2:0] {
    IDLE,
    STATE1,
    STATE2,
    ERROR
} state_t;

// –†–µ–≥–∏—Å—Ç—Ä—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π
state_t current_state;
state_t next_state;

// –ö–æ–º–±–∏–Ω–∞—Ü–∏–æ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
always_comb begin
    next_state = current_state;     // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è

    case (current_state)
        IDLE: begin
            if (start_condition) next_state = STATE1;
            if (error_condition) next_state = ERROR;
        end

        STATE1: begin
            if (continue_condition) next_state = STATE2;
            if (abort_condition)    next_state = IDLE;
        end

        // –î—Ä—É–≥–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è...

        ERROR: begin
            if (reset_condition) next_state = IDLE;
        end
    endcase
end

// –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
always_ff @(posedge clk) begin
    if (!resetn) begin
        current_state <= IDLE;
    end else begin
        current_state <= next_state;
    end
end

// –í—ã—Ö–æ–¥–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–ú—É—Ä)
always_comb begin
    // –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    output1 = '0;
    output2 = '0;

    case (current_state)
        IDLE:   begin output1 = '0; output2 = '0; end
        STATE1: begin output1 = '1; output2 = '0; end
        STATE2: begin output1 = '1; output2 = '1; end
        ERROR:  begin output1 = '0; output2 = '1; end
    endcase
end
```

### 6.3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–æ–≤

#### –¢–µ—Ö–Ω–∏–∫–∏ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π

**1. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π:**
```systemverilog
// –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥
enum {WAIT_DATA1, WAIT_DATA2, WAIT_DATA3, PROCESS} state;

// –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥
enum {WAIT_DATA, PROCESS} state;
logic [1:0] data_count;     // –°—á–µ—Ç—á–∏–∫ –ø—Ä–∏–Ω—è—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```

**2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤-—Ñ–ª–∞–≥–æ–≤:**
```systemverilog
// –í–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π
enum {IDLE, BUSY, DONE_A, DONE_B, DONE_AB} state;

// –õ—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–ª–∞–≥–∏
enum {IDLE, BUSY} state;
logic done_a, done_b;
```

**3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã:**
```systemverilog
// –û–¥–∏–Ω –±–æ–ª—å—à–æ–π –∞–≤—Ç–æ–º–∞—Ç (—Å–ª–æ–∂–Ω–æ)
enum {IDLE, RX_START, RX_DATA, TX_START, TX_DATA, RX_TX_CONFLICT} state;

// –î–≤–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–∞ (–ø—Ä–æ—â–µ)
enum {RX_IDLE, RX_START, RX_DATA} rx_state;
enum {TX_IDLE, TX_START, TX_DATA} tx_state;
```

### 6.4. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–æ–≤

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
```systemverilog
// Assertion –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç–∏–∂–∏–º–æ—Å—Ç–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π
property state_reachable(state_val);
    @(posedge clk) disable iff (!resetn)
    ##[1:1000] (current_state == state_val);
endproperty

assert property (state_reachable(STATE1))
    else $error("STATE1 never reached");
assert property (state_reachable(STATE2))
    else $error("STATE2 never reached");
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
```systemverilog
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
property no_direct_idle_to_state2;
    @(posedge clk) disable iff (!resetn)
    (current_state == IDLE) |=> (next_state != STATE2);
endproperty

assert property (no_direct_idle_to_state2)
    else $error("Illegal transition IDLE -> STATE2");
```

---

## 7. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –∏ –∫–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

–ì–ª–∞–≤–∞ 4 –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—é –∫–æ–Ω–µ—á–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤ –∫–∞–∫ –º–æ—â–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö —Å–∏—Å—Ç–µ–º:

#### üéØ **–ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏**
1. **–ê–≤—Ç–æ–º–∞—Ç—ã –ú–∏–ª–∏ vs –ú—É—Ä–∞** - —Ä–∞–∑–ª–∏—á–∏—è –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏
2. **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≥–∏–±–∫–æ—Å—Ç—å —á–µ—Ä–µ–∑ generate –±–ª–æ–∫–∏
3. **–ê–ª–≥–æ—Ä–∏—Ç–º—ã –±–µ–∑ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ–ª–µ–Ω–∏—è
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** - PLL, –¥–∏—Å–ø–ª–µ–∏, –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–µ–±–µ–∑–≥–∞
5. **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–ª–æ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–æ–≤

#### ‚ö° **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏**
1. **–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–æ–≤** - –æ—Ç –¥–∏–∞–≥—Ä–∞–º–º—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π –∫ –∫–æ–¥—É
2. **–û—Ç–ª–∞–¥–∫–∞ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ mark_debug –∏ ILA
3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏
4. **–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
5. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è** - –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Å–ª–µ–¥—É—é—â–∏–º —ç—Ç–∞–ø–∞–º

–ü–æ—Å–ª–µ –æ—Å–≤–æ–µ–Ω–∏—è –ì–ª–∞–≤—ã 4 –≤—ã –≥–æ—Ç–æ–≤—ã –∫:

#### üìö **–ì–ª–∞–≤–∞ 5: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è**
- **–ü—Ä–æ—Ç–æ–∫–æ–ª—ã —Å–≤—è–∑–∏** - –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–æ–≤ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ SPI, I2C, UART
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã** - –Ω–∞–≤—ã–∫–∏ –∞–Ω–∞–ª–∏–∑–∞ timing —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –æ—à–∏–±–æ–∫

#### üîß **–°–ª–æ–∂–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã**
- **–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** - –∫–æ–Ω–≤–µ–π–µ—Ä—ã, hazard detection
- **DSP –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** - —Ñ–∏–ª—å—Ç—Ä—ã, FFT, –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
- **–°–µ—Ç–µ–≤—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã** - TCP/IP —Å—Ç–µ–∫–∏, —Å–µ—Ç–µ–≤—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–∞–º–∏** - —Ä–æ–±–æ—Ç–∏–∫–∞, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

#### üé® **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏**
- **Hierarchical State Machines** - –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã
- **Concurrent State Machines** - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã
- **Model-Based Design** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –∏–∑ –º–æ–¥–µ–ª–µ–π

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

#### ‚ö†Ô∏è **–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞:**
1. **–í—Å–µ–≥–¥–∞ –æ–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ default
2. **–†–∞–∑–¥–µ–ª—è–π—Ç–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–æ–Ω–Ω—É—é –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–æ–≤
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ reset —Å–æ—Å—Ç–æ—è–Ω–∏—è** –≤–æ –≤—Å–µ—Ö –∞–≤—Ç–æ–º–∞—Ç–∞—Ö
4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π** –≤ —Å–∏–º—É–ª—è—Ü–∏–∏
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –¥–∏–∞–≥—Ä–∞–º–º—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π** - –æ–Ω–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è

#### üöÄ **–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:**
1. **–ú—É—Ä –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏, –ú–∏–ª–∏ –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —Ç–∏–ø–∞
2. **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** - —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –≥–∏–±–∫–∏–µ –º–æ–¥—É–ª–∏
3. **Mark_debug –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤** - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –æ—Ç–ª–∞–¥–∫–µ –≤ –∂–µ–ª–µ–∑–µ
4. **Comprehensive testbenches** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö corner cases
5. **Regular code reviews** - –∞–≤—Ç–æ–º–∞—Ç—ã —Å–ª–æ–∂–Ω–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –ø–æ—Å–ª–µ —Å–∏–Ω—Ç–µ–∑–∞

---

*–ì–ª–∞–≤–∞ 4 –∑–∞–≤–µ—Ä—à–∞–µ—Ç –∏–∑—É—á–µ–Ω–∏–µ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–æ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏ (–ì–ª–∞–≤–∞ 1), –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏ (–ì–ª–∞–≤–∞ 2), —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–∞–º—è—Ç–∏ (–ì–ª–∞–≤–∞ 3) –∏ –∞–≤—Ç–æ–º–∞—Ç–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏–π (–ì–ª–∞–≤–∞ 4) —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ª—é–±—ã—Ö —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ FPGA.*